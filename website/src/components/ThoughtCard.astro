---
import type { Thought } from "../lib/notion";

interface Props {
  thought: Thought;
}

const { thought } = Astro.props;

const sourceClass = thought.source.toLowerCase();
const formattedDate = new Date(thought.originalDate).toLocaleDateString(
  "en-US",
  {
    year: "numeric",
    month: "short",
    day: "numeric",
  },
);
const dateISO = thought.originalDate.split("T")[0];
---

<article class="thought-card" data-date={dateISO}>
  <header class="card-header">
    <span class={`badge ${sourceClass}`}>{thought.source}</span>
    <time datetime={thought.originalDate} class="text-muted text-small">
      {formattedDate}
    </time>
  </header>

  <div class="card-content">
    <p>{thought.content}</p>

    {
      (thought.images.length > 0 || thought.videos.length > 0) && (
        <div class="card-media">
          {thought.images.map((img) => (
            <img src={img} alt="" loading="lazy" />
          ))}
          {thought.videos.map((vid) => (
            <video src={vid} controls preload="none" />
          ))}
        </div>
      )
    }
  </div>

  <footer class="card-footer">
    {
      thought.tags.length > 0 && (
        <div class="card-tags">
          {thought.tags.map((tag) => (
            <span class="tag">#{tag}</span>
          ))}
        </div>
      )
    }
    {
      thought.originalUrl &&
        thought.originalUrl.startsWith("https://") &&
        (
          <a
            href={thought.originalUrl}
            target="_blank"
            rel="noopener"
            class="original-link"
          >
            View original â†’
          </a>
        )
    }
  </footer>
</article>

<!-- Styles moved to global.css to support dynamic rendering -->
